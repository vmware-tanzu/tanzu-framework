<div [ngClass]="{'hide': review}">
    <div class="clr-row mb-20">
        <div class="clr-col-12">
            <clr-icon shape="arrow" dir="left" size="30" class="is-info back-link"
                role="button"
                tabindex="0"
                aria-label="back"
                (click)="navigate(APP_ROUTES.LANDING)"
                keyboardListener
            ></clr-icon>
            <h2 i18n="wizard title" aria-level="1">
                <div class="vsphere-icon-30 offset-top-2"></div>
                Deploy {{ clusterTypeDescriptor | titlecase }} Cluster on vSphere
            </h2>
            <ng-container *featureToggle="'management-cluster.import'">
                <input type="file" class="file-input"
                       (change)="onImportFileSelected($event)" #fileUpload>
                <button class="btn btn-outline import-btn" (click)="onImportButtonClick() && fileUpload.click()"
                        i18n="import configuration button">
                    Import Configuration
                </button>
            </ng-container>
        </div>
    </div>
    <app-shared-delete-data-popup></app-shared-delete-data-popup>
    <!-- experimental -->
    <form clrStepper #wizard [formGroup]="form">
        <div *ngFor="let thisStepData of stepData; index as i">
            <clr-stepper-panel formGroupName="{{thisStepData.name}}" removeAriaLabelledBy>
                <clr-step-title i18n="{{thisStepData.i18n.title}}">{{ thisStepData.title }}</clr-step-title>
                <clr-step-description i18n="{{thisStepData.i18n.description}}">
                    {{ describeStep(thisStepData.name, thisStepData.description) }}
                </clr-step-description>
                <ng-container *ngIf="steps[i] && show">
                    <app-step-wrapper [registrar]="registrar" [formName]="thisStepData.name" [clazz]="thisStepData.clazz">
                    </app-step-wrapper>
                </ng-container>
                <clr-step-content *clrIfExpanded>
                    <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
                </clr-step-content>
            </clr-stepper-panel>
        </div>
    </form>
    <!-- original form
    <form clrStepper #wizard [formGroup]="form">
        <clr-stepper-panel formGroupName="{{VsphereProviderForm.name}}" removeAriaLabelledBy>
            <clr-step-title i18n="{{VsphereProviderForm.i18n.title}}">{{VsphereProviderForm.title}}</clr-step-title>
            <clr-step-description i18n="{{VsphereProviderForm.i18n.description}}">{{VsphereProviderForm.description}}</clr-step-description>
            <ng-container *ngIf="steps[0] && show">
                <app-vsphere-provider-step [formGroup]="form.controls[VsphereProviderForm.name]" formName="{{VsphereProviderForm.name}}">
                </app-vsphere-provider-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{VsphereNodeSettingForm.name}}" removeAriaLabelledBy>
            <clr-step-title i18n="{{VsphereNodeSettingForm.i18n.title}}">{{VsphereNodeSettingForm.title}}</clr-step-title>
            <clr-step-description i18n="{{VsphereNodeSettingForm.i18n.description}}">{{VsphereNodeSettingForm.description}}</clr-step-description>
            <ng-container *ngIf="steps[1]">
                <app-node-setting-step [formGroup]="form.controls[VsphereNodeSettingForm.name]" [providerType]="(provider | async)"
                    formName="{{VsphereNodeSettingForm.name}}">
                </app-node-setting-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{ VsphereLoadBalancerForm.name }}" removeAriaLabelledBy>
            <clr-step-title i18n="{{VsphereLoadBalancerForm.i18n.title}}">{{VsphereLoadBalancerForm.title}}</clr-step-title>
            <clr-step-description i18n="{{VsphereLoadBalancerForm.i18n.description}}">{{VsphereLoadBalancerForm.description}}</clr-step-description>
            <ng-container *ngIf="steps[2]">
                <app-load-balancer-step [formGroup]="form.controls[VsphereLoadBalancerForm.name]" formName="{{VsphereLoadBalancerForm.name}}">
                </app-load-balancer-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{ MetadataForm.name }}" removeAriaLabelledBy>
            <clr-step-title i18n="{{MetadataForm.i18n.title}}">{{ MetadataForm.title }}</clr-step-title>
            <clr-step-description i18n="{{MetadataForm.i18n.description}}">{{ MetadataForm.description }}</clr-step-description>
            <ng-container *ngIf="steps[3]">
                <app-metadata-step [formGroup]="form.controls[MetadataForm.name]" formName="{{ MetadataForm.name }}"></app-metadata-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{ VsphereResourceForm }}" removeAriaLabelledBy>
            <clr-step-title i18n="Resource step name">
                Resources
            </clr-step-title>
            <clr-step-description i18n="Resource step description">
                {{ VsphereResourceFormDescription }}
            </clr-step-description>
            <ng-container *ngIf="steps[4]">
                <app-resource-step [formGroup]="form.controls[VsphereResourceForm]" formName="{{ VsphereResourceForm }}">
                </app-resource-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{ NetworkForm.name }}" removeAriaLabelledBy>
            <clr-step-title i18n="{{NetworkForm.i18n.title}}">{{ NetworkForm.title }}</clr-step-title>
            <clr-step-description i18n="{{NetworkForm.i18n.description}}">{{ NetworkForm.description }}</clr-step-description>
            <ng-container *ngIf="steps[5]">
                <app-shared-network-step [formGroup]="form.controls[NetworkForm.name]"
                    enableNetworkName="true" enableNoProxyWarning="true" formName="{{ NetworkForm.name }}">
                </app-shared-network-step>
            </ng-container>
            <clr-step-content *clrIfExpanded><app-step-controller (nextStep)="onNextStep()"></app-step-controller></clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{ IdentityForm.name }}" removeAriaLabelledBy>
            <clr-step-title i18n="{{IdentityForm.i18n.title}}">{{ IdentityForm.title }}</clr-step-title>
            <clr-step-description i18n="{{IdentityForm.i18n.description}}">{{ IdentityForm.description }}</clr-step-description>
            <ng-container *ngIf="steps[6]">
                <app-shared-identity-step [formGroup]="form.controls[IdentityForm.name]" formName="{{ IdentityForm.name }}">
                </app-shared-identity-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{ OsImageForm.name }}" removeAriaLabelledBy>
            <clr-step-title i18n="{{OsImageForm.i18n.title}}">{{ OsImageForm.title }}</clr-step-title>
            <clr-step-description i18n="{{OsImageForm.i18n.description}}">{{ OsImageForm.description }}</clr-step-description>
            <ng-container *ngIf="steps[7]">
                <app-os-image-step [formGroup]="form.controls[OsImageForm.name]"
                    formName="{{ OsImageForm.name }}" [wizardFormService]="wizardFormService" type="VSPHERE"
                    [noImageAlertMessage]="'Your ' + clusterTypeDescriptor + ' cluster will be deployed with Tanzu Kubernetes release (TKr) ' + (tkrVersion | async) +
                                    '. We are unable to detect a VM template that belongs to this Tanzu Kubernetes release. You must install ' +
                                    'a VM template that belongs to Tanzu Kubernetes release ' +  (tkrVersion | async) + ' to continue with deployment of the ' +
                                    clusterTypeDescriptor + ' cluster. You may click the refresh icon to reload the OS image list once the ' +
                                    'appropriate VM template has been installed.'"
                    osImageTooltipContent="Select a VM template for a base OS image that you have already imported
                                    into vSphere. If no compatible template is present, import one into
                                    vSphere and click the Refresh button."
                    enableNonTemplateAlert=true
                    >
                </app-os-image-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>

        <clr-stepper-panel formGroupName="{{CeipForm.name}}" removeAriaLabelledBy *ngIf="edition === 'tkg'">
            <clr-step-title i18n="{{CeipForm.i18n.title}}">{{CeipForm.title}}</clr-step-title>
            <clr-step-description i18n="{{CeipForm.i18n.description}}">{{CeipForm.title}}</clr-step-description>
            <ng-container *ngIf="steps[8]">
                <app-shared-ceip-step [formGroup]="form.controls[CeipForm.name]" formName="{{CeipForm.name}}">
                </app-shared-ceip-step>
            </ng-container>
            <clr-step-content *clrIfExpanded>
                <app-step-controller (nextStep)="onNextStep()"></app-step-controller>
            </clr-step-content>
        </clr-stepper-panel>
    </form>
-->
    <button class="btn btn-primary mt-20" [disabled]="!getWizardValidity()" (click)="reviewConfiguration(true)"
        i18n="review cluster configuration btn">
        REVIEW CONFIGURATION
    </button>
</div>

<ng-container *ngIf="review">
    <tkg-kickstart-ui-confirm></tkg-kickstart-ui-confirm>
    <app-error-notification [errorNotification]="errorNotification"></app-error-notification>
    <div class="clr-row mt-20">
        <div class="clr-col-12 btn-container">
            <button class="btn btn-primary deploy-btn" [disabled]="disableDeployButton" (click)="deploy()"
                    i18n="deploy cluster configuration btn">
                Deploy {{ clusterTypeDescriptor | titlecase }} Cluster
            </button>
            <button class="btn btn-outline edit-btn" (click)="reviewConfiguration(false)"
                i18n="return to wizard for edit button">
                Edit Configuration
            </button>
            <ng-container *featureToggle="'management-cluster.export-from-confirm'">
                <button class="btn btn-link export-btn" (click)="exportConfiguration()"
                        i18n="export configuration button">
                    Export Configuration
                </button>
            </ng-container>
        </div>
    </div>
</ng-container>
